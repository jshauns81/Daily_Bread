@namespace Daily_Bread.Components.Shared

<div class="date-navigation">
    <button class="btn btn-outline-secondary"
            @onclick="GoToPreviousDay"
            disabled="@(!CanNavigateBack)">
        <span class="bi bi-chevron-left"></span> Previous
    </button>

    <div class="current-date">
        <span class="date-display">@SelectedDate.ToString("dddd, MMMM d, yyyy")</span>
        @if (IsToday)
        {
            <span class="badge bg-primary ms-2">Today</span>
        }
    </div>

    <button class="btn btn-outline-secondary"
            @onclick="GoToNextDay"
            disabled="@(!CanNavigateForward)">
        Next <span class="bi bi-chevron-right"></span>
    </button>

    @if (!IsToday)
    {
        <button class="btn btn-outline-primary ms-2" @onclick="GoToToday">
            Go to Today
        </button>
    }
</div>

@code {
    [Parameter, EditorRequired]
    public DateOnly SelectedDate { get; set; }

    [Parameter, EditorRequired]
    public DateOnly Today { get; set; }

    [Parameter]
    public EventCallback<DateOnly> SelectedDateChanged { get; set; }

    /// <summary>
    /// If true, allows navigating to past dates. If false, only today and forward.
    /// </summary>
    [Parameter]
    public bool AllowPastNavigation { get; set; } = true;

    /// <summary>
    /// If true, allows navigating to future dates. If false, only today and back.
    /// </summary>
    [Parameter]
    public bool AllowFutureNavigation { get; set; } = true;

    private bool IsToday => SelectedDate == Today;

    private bool CanNavigateBack => AllowPastNavigation || IsToday;
    private bool CanNavigateForward => AllowFutureNavigation || SelectedDate < Today;

    private async Task GoToPreviousDay()
    {
        await SelectedDateChanged.InvokeAsync(SelectedDate.AddDays(-1));
    }

    private async Task GoToNextDay()
    {
        await SelectedDateChanged.InvokeAsync(SelectedDate.AddDays(1));
    }

    private async Task GoToToday()
    {
        await SelectedDateChanged.InvokeAsync(Today);
    }
}
