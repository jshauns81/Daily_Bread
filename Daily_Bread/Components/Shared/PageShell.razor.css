/* ===========================================
   PageShell - Reusable Page Layout Component
   Provides PWA-safe layout with header, content, and bottom nav
   =========================================== */

.page-shell {
    display: flex;
    flex-direction: column;
    /* Use dynamic viewport height accounting for mobile header */
    min-height: calc(100vh - 56px - env(safe-area-inset-top, 0px)); /* Fallback for older browsers */
    min-height: calc(100dvh - 56px - env(safe-area-inset-top, 0px));
    max-width: 100%;
    overflow-x: hidden;
}

/* ===========================================
   HEADER
   =========================================== */

.page-shell__header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: var(--ds-space-4);
    background-color: var(--ds-bg-elevated);
    border-bottom: 1px solid var(--ds-bg-muted);
    flex-shrink: 0;
    position: sticky;
    top: 0;
    z-index: 50;
}

.page-shell__title {
    margin: 0;
    font-size: var(--ds-text-xl);
    font-weight: var(--ds-font-semibold);
    color: var(--ds-text-primary);
    line-height: 1.2;
}

.page-shell__header-actions {
    display: flex;
    align-items: center;
    gap: var(--ds-space-2);
}

/* ===========================================
   CONTENT
   =========================================== */

.page-shell__content {
    flex: 1;
    padding: var(--ds-space-4);
    overflow-y: auto;
    overflow-x: hidden;
    -webkit-overflow-scrolling: touch;
    /* Prevent overscroll on content area */
    overscroll-behavior-y: contain;
}

/* Content padding when bottom nav is present */
.page-shell--has-bottom-nav .page-shell__content {
    padding-bottom: calc(var(--bottom-nav-height, 60px) + env(safe-area-inset-bottom, 0px) + var(--ds-space-6));
}

/* ===========================================
   BOTTOM NAV
   =========================================== */

.page-shell__bottom-nav {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    z-index: 100;
    display: flex;
    justify-content: space-around;
    align-items: center;
    min-height: var(--bottom-nav-height, 60px);
    /* Padding with safe area for iPhone home indicator */
    padding: var(--ds-space-2) var(--ds-space-4);
    padding-bottom: max(var(--ds-space-2), env(safe-area-inset-bottom, 0px));
    padding-left: max(var(--ds-space-4), env(safe-area-inset-left, 0px));
    padding-right: max(var(--ds-space-4), env(safe-area-inset-right, 0px));
    /* Frosted glass effect */
    background-color: rgba(59, 66, 82, 0.9);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border-top: 1px solid var(--ds-bg-muted);
    box-shadow: 0 -2px 20px rgba(0, 0, 0, 0.2);
}

/* ===========================================
   FOOTER
   =========================================== */

.page-shell__footer {
    flex-shrink: 0;
    padding: var(--ds-space-4);
    padding-bottom: max(var(--ds-space-4), env(safe-area-inset-bottom, 0px));
    background-color: var(--ds-bg-elevated);
    border-top: 1px solid var(--ds-bg-muted);
}

/* ===========================================
   DESKTOP LAYOUT
   =========================================== */

@media (min-width: 768px) {
    .page-shell {
        /* Desktop doesn't need mobile viewport adjustments */
        min-height: auto;
    }

    .page-shell__header {
        position: relative;
        top: auto;
    }

    .page-shell__content {
        padding: var(--ds-space-6);
        max-width: 1200px;
        margin: 0 auto;
        width: 100%;
    }

    /* Desktop: inline bottom nav, not fixed */
    .page-shell--has-bottom-nav .page-shell__content {
        padding-bottom: var(--ds-space-6);
    }

    .page-shell__bottom-nav {
        position: relative;
        bottom: auto;
        left: auto;
        right: auto;
        background: transparent;
        backdrop-filter: none;
        -webkit-backdrop-filter: none;
        box-shadow: none;
        border-top: 1px solid var(--ds-bg-muted);
        padding: var(--ds-space-4);
        min-height: auto;
    }
}

/* ===========================================
   MOBILE OPTIMIZATIONS
   =========================================== */

@media (max-width: 575.98px) {
    .page-shell__header {
        padding: var(--ds-space-2) var(--ds-space-4);
    }

    .page-shell__title {
        font-size: var(--ds-text-lg);
    }

    .page-shell__content {
        padding: var(--ds-space-2);
    }

    .page-shell--has-bottom-nav .page-shell__content {
        padding-bottom: calc(var(--bottom-nav-height, 60px) + env(safe-area-inset-bottom, 0px) + var(--ds-space-6));
    }
}

/* ===========================================
   TOUCH DEVICE OPTIMIZATIONS
   =========================================== */

@media (hover: none) and (pointer: coarse) {
    .page-shell__bottom-nav {
        /* Larger touch targets on touch devices */
        min-height: calc(var(--bottom-nav-height, 60px) + 8px);
    }
}

/* ===========================================
   REDUCED MOTION
   =========================================== */

@media (prefers-reduced-motion: reduce) {
    .page-shell__header,
    .page-shell__bottom-nav {
        transition: none;
    }
}
